<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Photometry from gaia coordinates" href="gaia_photometry.html" /><link rel="prev" title="Near Eclipsing Binary diagnostic" href="../neb.html" />

    <meta name="generator" content="sphinx-4.4.0, furo 2022.03.04"/>
        <title>Diagnostic video - prose</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=935aa2abcc5c1da4283d1dc201fb1f0add16d23a" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=25ceb02ed1c46dc30f2321ff83e92799f69dfdb9" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">prose</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">prose</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core.html">What is a pipeline?</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../blocks.html">Blocks</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.SegmentedPeaks.html">prose.blocks.SegmentedPeaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.SEDetection.html">prose.blocks.SEDetection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.DAOFindStars.html">prose.blocks.DAOFindStars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Cutouts.html">prose.blocks.Cutouts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.MedianPSF.html">prose.blocks.MedianPSF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.FWHM.html">prose.blocks.FWHM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Gaussian2D.html">prose.blocks.Gaussian2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Moffat2D.html">prose.blocks.Moffat2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.FastGaussian.html">prose.blocks.FastGaussian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.XYShift.html">prose.blocks.XYShift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Twirl.html">prose.blocks.Twirl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.AffineTransform.html">prose.blocks.AffineTransform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Cutout2D.html">prose.blocks.Cutout2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.AstroAlignShift.html">prose.blocks.AstroAlignShift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.PhotutilsAperturePhotometry.html">prose.blocks.PhotutilsAperturePhotometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.PhotutilsPSFPhotometry.html">prose.blocks.PhotutilsPSFPhotometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.SEAperturePhotometry.html">prose.blocks.SEAperturePhotometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Calibration.html">prose.blocks.Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Cutouts.html">prose.blocks.Cutouts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Flip.html">prose.blocks.Flip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.ImageBuffer.html">prose.blocks.ImageBuffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Pass.html">prose.blocks.Pass</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.SaveReduced.html">prose.blocks.SaveReduced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Set.html">prose.blocks.Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Stack.html">prose.blocks.Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.Trim.html">prose.blocks.Trim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.blocks.XArray.html">prose.blocks.XArray</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.Image.html">prose.Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.Block.html">prose.Block</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.Sequence.html">prose.Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.Telescope.html">prose.Telescope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.FitsManager.html">prose.FitsManager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.Observation.html">prose.Observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.pipeline.Calibration.html">prose.pipeline.Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.pipeline.AperturePhotometry.html">prose.pipeline.AperturePhotometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/prose.fluxes.ApertureFluxes.html">prose.fluxes.ApertureFluxes</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../fits_manager.html">Fits manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reduction.html">Photometric reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_pipeline.html">Custom pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reports.html">Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../neb.html">Near Eclipsing Binary diagnostic</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Case studies 🔭</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Diagnostic video</a></li>
<li class="toctree-l1"><a class="reference internal" href="gaia_photometry.html">Photometry from gaia coordinates</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../phot.html">Data products: <code class="docutils literal notranslate"><span class="pre">.phot</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../extra.html">Useful tips</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Diagnostic-video">
<h1>Diagnostic video<a class="headerlink" href="#Diagnostic-video" title="Permalink to this headline">#</a></h1>
<p>When doing an observation to commission a new instrument, or simply to know what’s going on with a certain night, it is sometimes usefull to fully visualize the reduction process of raw images 🧐</p>
<p>In this case study we will see how to produce that with prose. One thing we will focus on is how well images are aligned and what’s the shape of the PSF over the course of an observation</p>
<section id="Retrieving-the-images">
<h2>Retrieving the images<a class="headerlink" href="#Retrieving-the-images" title="Permalink to this headline">#</a></h2>
<p>As usual, we parse our images folder with a <code class="docutils literal notranslate"><span class="pre">FitsManager</span></code> instance</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">prose</span> <span class="kn">import</span> <span class="n">FitsManager</span>

<span class="n">fm</span> <span class="o">=</span> <span class="n">FitsManager</span><span class="p">(</span><span class="s2">"/Users/lgrcia/data/RAW_Callisto_20210927_Sp2315-0627_I+z/"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████████████████████████████████████████████████████████████████████████| 255/255 [00:00&lt;00:00, 1134.63it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Observations:
╒═════════╤════════════╤═════════════╤═════════════╤══════════╤════════════╤════════╤════════════╕
│   index │ date       │ telescope   │ target      │ filter   │   exposure │ type   │   quantity │
╞═════════╪════════════╪═════════════╪═════════════╪══════════╪════════════╪════════╪════════════╡
│       0 │ 2021-09-26 │ Callisto    │ Sp2315-0627 │ I+z      │         12 │ light  │        232 │
╘═════════╧════════════╧═════════════╧═════════════╧══════════╧════════════╧════════╧════════════╛
Calibrations:
╒════════════╤═════════════╤══════════╤══════════╤════════════╤════════╤════════════╕
│ date       │ telescope   │ target   │ filter   │   exposure │ type   │   quantity │
╞════════════╪═════════════╪══════════╪══════════╪════════════╪════════╪════════════╡
│ 2021-09-26 │ Callisto    │          │          │       0    │ bias   │          2 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │          │      15    │ dark   │          1 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │          │      30    │ dark   │          3 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │          │      60    │ dark   │          3 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │          │     120    │ dark   │          1 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │ I+z      │       6    │ flat   │          2 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │ I+z      │       6.13 │ flat   │          1 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │ I+z      │       6.81 │ flat   │          1 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │ I+z      │       7.61 │ flat   │          1 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │ I+z      │       8.51 │ flat   │          1 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │ I+z      │       9.26 │ flat   │          1 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │ I+z      │      10.57 │ flat   │          1 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │ I+z      │      12.11 │ flat   │          1 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │ I+z      │      13.92 │ flat   │          1 │
├────────────┼─────────────┼──────────┼──────────┼────────────┼────────┼────────────┤
│ 2021-09-26 │ Callisto    │          │ I+z      │      15    │ flat   │          3 │
╘════════════╧═════════════╧══════════╧══════════╧════════════╧════════╧════════════╛
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
</section>
<section id="Reference-sequence">
<h2>Reference sequence<a class="headerlink" href="#Reference-sequence" title="Permalink to this headline">#</a></h2>
<p>Since the goal is to align raw images, let’s detect reference stars on a reference image.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">prose</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">blocks</span>

<span class="c1"># We take one of the image as a reference one</span>
<span class="n">reference</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">50</span><span class="p">])</span>

<span class="c1"># Defining the reference sequence</span>
<span class="n">reference_sequence</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">([</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">Calibration</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">darks</span><span class="p">,</span> <span class="n">fm</span><span class="o">.</span><span class="n">flats</span><span class="p">,</span> <span class="n">fm</span><span class="o">.</span><span class="n">bias</span><span class="p">),</span> <span class="c1"># calibration</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">Trim</span><span class="p">(),</span>                                   <span class="c1"># triming</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">SegmentedPeaks</span><span class="p">(</span><span class="n">n_stars</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>               <span class="c1"># stars detection</span>
<span class="p">])</span>

<span class="c1"># Running it and displaying the reference stars</span>
<span class="n">reference_sequence</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">reference</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-blue-intense-fg">INFO</span> Building master bias
<span class="ansi-blue-intense-fg">INFO</span> Building master dark
<span class="ansi-blue-intense-fg">INFO</span> Building master flat
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_case_studies_diagnostic_video_5_1.png" src="../../_images/notebooks_case_studies_diagnostic_video_5_1.png"/>
</div>
</div>
<p>We can now reuse this sequence and apply it to the complete set of images.</p>
</section>
<section id="The-rest-of-the-sequence">
<h2>The rest of the sequence<a class="headerlink" href="#The-rest-of-the-sequence" title="Permalink to this headline">#</a></h2>
<p>Let’s now build the sequence to take the measurements and align images</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Just running it on a test image</span>
<span class="n">test_image</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>

<span class="n">main_sequence</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">([</span>
    <span class="o">*</span><span class="n">reference_sequence</span><span class="p">,</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">XYShift</span><span class="p">(</span><span class="n">reference</span><span class="o">.</span><span class="n">stars_coords</span><span class="p">),</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">Cutouts</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">41</span><span class="p">),</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">MedianPSF</span><span class="p">(),</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">Moffat2D</span><span class="p">()</span>
<span class="p">])</span>

<span class="n">main_sequence</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-blue-intense-fg">RUN</span> 100%|<span class="ansi-blue-intense-fg">█████████████████████████████████████</span>| 1/1 [00:00&lt;00:00,  6.88images/s]
</pre></div></div>
</div>
</section>
<section id="The-PlotVideo-block">
<h2>The <code class="docutils literal notranslate"><span class="pre">PlotVideo</span></code> block<a class="headerlink" href="#The-PlotVideo-block" title="Permalink to this headline">#</a></h2>
<p>To build a video of the reduction process of all images, we will use the <code class="docutils literal notranslate"><span class="pre">PlotVideo</span></code> block which takes as input a plotting function applied to an image. Let’s write it</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">gridspec</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">prose</span> <span class="kn">import</span> <span class="n">viz</span>

<span class="c1"># focusing plot on</span>
<span class="n">xy</span> <span class="o">=</span> <span class="n">reference</span><span class="o">.</span><span class="n">stars_coords</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Alignment</span>
    <span class="n">subfigs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subfigures</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">reference</span><span class="o">.</span><span class="n">show_cutout</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"Greys_r"</span><span class="p">,</span> <span class="n">stars</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">reference</span><span class="o">.</span><span class="n">stars_coords</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s2">"+"</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"C0"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"reference"</span><span class="p">)</span>
    <span class="n">image</span><span class="o">.</span><span class="n">show_cutout</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"Blues_r"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">stars</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">image</span><span class="o">.</span><span class="n">stars_coords</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s2">"+"</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"detected"</span><span class="p">)</span>
    <span class="n">viz</span><span class="o">.</span><span class="n">corner_text</span><span class="p">(</span><span class="sa">f</span><span class="s2">"dx: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">dx</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s2">dy: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">dy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"w"</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">"left"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># PSF</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
        <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">axr</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">axt</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">psf</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"Blues_r"</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">"lower"</span><span class="p">)</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">psf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="n">axt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">psf</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">"C0"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"data"</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">psf_model</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">"--"</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"model"</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Median PSF Model (</span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">psf_model_block</span><span class="si">}</span><span class="s2">)"</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">"left"</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">axr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">psf</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">"C0"</span><span class="p">)</span>
    <span class="n">axr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">psf_model</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"--"</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">)</span>
    <span class="n">axr</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"FWHM x: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">fwhmx</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> pix</span><span class="se">\n</span><span class="s2">"</span>
                <span class="sa">f</span><span class="s2">"FWHM y: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">fwhmy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> pix</span><span class="se">\n</span><span class="s2">"</span>
                <span class="sa">f</span><span class="s2">"angle: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">theta</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">180</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">°"</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"w"</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="c1"># Here is the result</span>
<span class="n">plot</span><span class="p">(</span><span class="n">test_image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_case_studies_diagnostic_video_11_0.png" src="../../_images/notebooks_case_studies_diagnostic_video_11_0.png"/>
</div>
</div>
<p>And use it within the full sequence</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">([</span>
    <span class="o">*</span><span class="n">main_sequence</span><span class="p">,</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">vizualisation</span><span class="o">.</span><span class="n">PlotVideo</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"test.mp4"</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-blue-intense-fg">RUN</span> 100%|<span class="ansi-blue-intense-fg">█████████████████████████████████</span>| 232/232 [01:36&lt;00:00,  2.39images/s]
IMAGEIO FFMPEG_WRITER WARNING: input image is not divisible by macro_block_size=16, resizing from (720, 360) to (720, 368) to ensure video compatibility with most codecs and players. To prevent resizing, make your input image divisible by the macro_block_size or set the macro_block_size to 1 (risking incompatibility).
</pre></div></div>
</div>
</section>
<section id="A-concise-code">
<h2>A concise code<a class="headerlink" href="#A-concise-code" title="Permalink to this headline">#</a></h2>
<p>We have seen all the steps and details on how to use a plotting function within a sequence. For reference and clarity here is the final code containing the reference and main sequences:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">prose</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">blocks</span>

<span class="c1"># We take one of the image as a reference one</span>
<span class="n">reference</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">50</span><span class="p">])</span>

<span class="c1"># Reference sequence</span>
<span class="c1"># ------------------</span>
<span class="n">reference_sequence</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">([</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">Calibration</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">darks</span><span class="p">,</span> <span class="n">fm</span><span class="o">.</span><span class="n">flats</span><span class="p">,</span> <span class="n">fm</span><span class="o">.</span><span class="n">bias</span><span class="p">),</span>  <span class="c1"># calibration</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">Trim</span><span class="p">(),</span>                                    <span class="c1"># triming</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">SegmentedPeaks</span><span class="p">(</span><span class="n">n_stars</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>                <span class="c1"># stars detection</span>
<span class="p">])</span>

<span class="n">reference_sequence</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Main Sequence</span>
<span class="c1"># -------------</span>
<span class="n">main_sequence</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">([</span>
    <span class="o">*</span><span class="n">reference_sequence</span><span class="p">,</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">XYShift</span><span class="p">(</span><span class="n">reference</span><span class="o">.</span><span class="n">stars_coords</span><span class="p">),</span>           <span class="c1"># computing shift</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">Cutouts</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">41</span><span class="p">),</span>                          <span class="c1"># extracting stars cutouts</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">MedianPSF</span><span class="p">(),</span>                               <span class="c1"># combining into a median PSF</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">Moffat2D</span><span class="p">(),</span>                                <span class="c1"># PSF model</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">vizualisation</span><span class="o">.</span><span class="n">PlotVideo</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"test.gif"</span><span class="p">)</span>  <span class="c1"># Video block (here a gif to display in the notebook)</span>
<span class="p">])</span>

<span class="n">main_sequence</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">60</span><span class="p">])</span> <span class="c1"># just 10 for example</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-blue-intense-fg">INFO</span> Building master bias
<span class="ansi-blue-intense-fg">INFO</span> Building master dark
<span class="ansi-blue-intense-fg">INFO</span> Building master flat
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-blue-intense-fg">RUN</span> 100%|<span class="ansi-blue-intense-fg">███████████████████████████████████</span>| 10/10 [00:59&lt;00:00,  5.97s/images]
</pre></div></div>
</div>
<img alt="test.gif" src="../../_images/test.gif"/>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="gaia_photometry.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Photometry from gaia coordinates</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../neb.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Near Eclipsing Binary diagnostic</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Lionel Garcia
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Diagnostic video</a><ul>
<li><a class="reference internal" href="#Retrieving-the-images">Retrieving the images</a></li>
<li><a class="reference internal" href="#Reference-sequence">Reference sequence</a></li>
<li><a class="reference internal" href="#The-rest-of-the-sequence">The rest of the sequence</a></li>
<li><a class="reference internal" href="#The-PlotVideo-block">The <code class="docutils literal notranslate"><span class="pre">PlotVideo</span></code> block</a></li>
<li><a class="reference internal" href="#A-concise-code">A concise code</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>